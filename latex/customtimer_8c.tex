\hypertarget{customtimer_8c}{\section{customtimer.\-c File Reference}
\label{customtimer_8c}\index{customtimer.\-c@{customtimer.\-c}}
}
{\ttfamily \#include \char`\"{}customtimer.\-h\char`\"{}}\\*
{\ttfamily \#include $<$avr/interrupt.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
Include dependency graph for customtimer.\-c\-:
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{customtimer_8c_acdb18153473a1f7725aded7d4c07f8d9}{set\-\_\-ovfs\-\_\-and\-\_\-ticks} (float seconds, \hyperlink{test_8h_aa93ac051f2256663466253286bfef785}{uint16\-\_\-t} $\ast$t\-\_\-ovf, \hyperlink{test_8h_aa93ac051f2256663466253286bfef785}{uint16\-\_\-t} $\ast$t\-\_\-ticks)
\begin{DoxyCompactList}\small\item\em Calculate necessary overflows and timer-\/ticks. \end{DoxyCompactList}\item 
\hyperlink{test_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{customtimer_8c_a13781c9f99dee91ba7f69019482d39c8}{prepare\-\_\-countdowns} (\hyperlink{test_8h_aa93ac051f2256663466253286bfef785}{uint16\-\_\-t} n\-\_\-cds, float $\ast$seconds, \hyperlink{customtimer_8h_ad3a17d16a861e5cdc4f4af2ed19fa407}{T\-\_\-\-C\-A\-L\-L\-B\-A\-C\-K} $\ast$callbacks)
\begin{DoxyCompactList}\small\item\em Prepare a number of countdowns. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_a29bbe0721066f0c40993910980eeda42}{prescale\-\_\-1024} (void)
\begin{DoxyCompactList}\small\item\em Set the prescaler of T\-C\-C\-R1 to 1024. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_adaa3a4b597c87a8e1395fb1804dcbf23}{stop\-\_\-timer} (void)
\item 
\hyperlink{test_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{customtimer_8c_aee1ba92a934e50c14af5def052598ca1}{prepare\-\_\-single\-\_\-countdown} (float seconds, \hyperlink{customtimer_8h_ad3a17d16a861e5cdc4f4af2ed19fa407}{T\-\_\-\-C\-A\-L\-L\-B\-A\-C\-K} callback)
\begin{DoxyCompactList}\small\item\em Prepare a single countdown. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_a32a1b40c5cc606cb2ec32424a49dd9db}{start\-\_\-overflow\-\_\-timer} (void)
\begin{DoxyCompactList}\small\item\em Start the timer, triggering interrupts on overflows. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_aaaac2a3612ddaaa092b2883d194c1328}{start\-\_\-compare\-\_\-timer} (void)
\begin{DoxyCompactList}\small\item\em Start the timer, triggering compare interrupts. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_aa9854f34aab8315190c2d5945e54b058}{start\-\_\-timer} (void)
\begin{DoxyCompactList}\small\item\em Execute a timer, running the countdown at \-\_\-\-C\-T\-\_\-\-O.\-\_\-cur\-\_\-cd. \end{DoxyCompactList}\item 
\hyperlink{test_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{customtimer_8c_a3ce5712f831e6d5a5a06104422c523b6}{run\-\_\-countdown} (void)
\begin{DoxyCompactList}\small\item\em Execute all configured countdowns. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_ae17cda8a1068e9f0eb197408ce62dc33}{reset\-\_\-all\-\_\-countdowns} (void)
\begin{DoxyCompactList}\small\item\em Stop and reset all configured countdowns. \end{DoxyCompactList}\item 
void \hyperlink{customtimer_8c_a07b224b7ccf749d8facbab230cf950fc}{callback\-\_\-and\-\_\-next} (void)
\begin{DoxyCompactList}\small\item\em Execute a countdown'c callback. \end{DoxyCompactList}\item 
\hyperlink{test_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{customtimer_8c_aebdb57deac5566dacd4e8731b14af18f}{check\-\_\-and\-\_\-inc\-\_\-steps} (void)
\begin{DoxyCompactList}\small\item\em Increment the amount of already passed overflows. \end{DoxyCompactList}\item 
\hyperlink{customtimer_8c_ad39420cdd896dd12c68e36313139d0a5}{I\-S\-R} (T\-I\-M\-E\-R1\-\_\-\-C\-O\-M\-P\-A\-\_\-vect)
\item 
\hyperlink{customtimer_8c_ab16889ae984b9b798989a0d239283cac}{I\-S\-R} (T\-I\-M\-E\-R1\-\_\-\-O\-V\-F\-\_\-vect)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structCustomTimer}{Custom\-Timer} \hyperlink{customtimer_8c_af5583a393df5eb6d7dbd289b13beba06}{\-\_\-\-C\-T\-\_\-\-O}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{customtimer_8c_a07b224b7ccf749d8facbab230cf950fc}{\index{customtimer.\-c@{customtimer.\-c}!callback\-\_\-and\-\_\-next@{callback\-\_\-and\-\_\-next}}
\index{callback\-\_\-and\-\_\-next@{callback\-\_\-and\-\_\-next}!customtimer.c@{customtimer.\-c}}
\subsubsection[{callback\-\_\-and\-\_\-next}]{\setlength{\rightskip}{0pt plus 5cm}void callback\-\_\-and\-\_\-next (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_a07b224b7ccf749d8facbab230cf950fc}


Execute a countdown'c callback. 

{\bfseries Note}\-: since this is run inside an interrupt-\/routine, the callbacks must not be heavy operations.\par
After executing a countdown's callback, the next countdown is started. When no next countdown is available, the timer is stopped.\par
{\bfseries Note}\-: When another countdown is supposed to follow, the timer for that next countdown is started {\bfseries before} the callback is executed. This might lead to an undesired behavior, if the next countdown is finished before the current callback finished executing. \hypertarget{customtimer_8c_aebdb57deac5566dacd4e8731b14af18f}{\index{customtimer.\-c@{customtimer.\-c}!check\-\_\-and\-\_\-inc\-\_\-steps@{check\-\_\-and\-\_\-inc\-\_\-steps}}
\index{check\-\_\-and\-\_\-inc\-\_\-steps@{check\-\_\-and\-\_\-inc\-\_\-steps}!customtimer.c@{customtimer.\-c}}
\subsubsection[{check\-\_\-and\-\_\-inc\-\_\-steps}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint8\-\_\-t} check\-\_\-and\-\_\-inc\-\_\-steps (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_aebdb57deac5566dacd4e8731b14af18f}


Increment the amount of already passed overflows. 

\begin{DoxyReturn}{Returns}
{\ttfamily {\bfseries 0}} if not all overflows have happend yet, {\bfseries 1} otherwise. 
\end{DoxyReturn}
\hypertarget{customtimer_8c_ad39420cdd896dd12c68e36313139d0a5}{\index{customtimer.\-c@{customtimer.\-c}!I\-S\-R@{I\-S\-R}}
\index{I\-S\-R@{I\-S\-R}!customtimer.c@{customtimer.\-c}}
\subsubsection[{I\-S\-R}]{\setlength{\rightskip}{0pt plus 5cm}I\-S\-R (
\begin{DoxyParamCaption}
\item[{T\-I\-M\-E\-R1\-\_\-\-C\-O\-M\-P\-A\-\_\-vect}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_ad39420cdd896dd12c68e36313139d0a5}
\hypertarget{customtimer_8c_ab16889ae984b9b798989a0d239283cac}{\index{customtimer.\-c@{customtimer.\-c}!I\-S\-R@{I\-S\-R}}
\index{I\-S\-R@{I\-S\-R}!customtimer.c@{customtimer.\-c}}
\subsubsection[{I\-S\-R}]{\setlength{\rightskip}{0pt plus 5cm}I\-S\-R (
\begin{DoxyParamCaption}
\item[{T\-I\-M\-E\-R1\-\_\-\-O\-V\-F\-\_\-vect}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_ab16889ae984b9b798989a0d239283cac}
\hypertarget{customtimer_8c_a13781c9f99dee91ba7f69019482d39c8}{\index{customtimer.\-c@{customtimer.\-c}!prepare\-\_\-countdowns@{prepare\-\_\-countdowns}}
\index{prepare\-\_\-countdowns@{prepare\-\_\-countdowns}!customtimer.c@{customtimer.\-c}}
\subsubsection[{prepare\-\_\-countdowns}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint8\-\_\-t} prepare\-\_\-countdowns (
\begin{DoxyParamCaption}
\item[{{\bf uint16\-\_\-t}}]{n\-\_\-cds, }
\item[{float $\ast$}]{seconds, }
\item[{{\bf T\-\_\-\-C\-A\-L\-L\-B\-A\-C\-K} $\ast$}]{callbacks}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_a13781c9f99dee91ba7f69019482d39c8}


Prepare a number of countdowns. 

{\bfseries Overwrite} all existing countdowns with the parameters. This function will fail, either when a countdown is currently running or when the desired number of countdowns exceeds \hyperlink{customtimer_8h_aa856fcb7aee41aa2cdd570d9472fa2a5}{M\-A\-X\-\_\-\-C\-O\-U\-N\-T\-D\-O\-W\-N\-S}. \begin{DoxyReturn}{Returns}
{\ttfamily {\bfseries 1}} on success, {\bfseries 0} on failure. 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em n\-\_\-cds} & Number of desired countdowns \\
\hline
{\em seconds} & Array of length $<$n\-\_\-cds$>$, containing the time for each countdown \\
\hline
{\em callbacks} & Array of length $<$n\-\_\-cds$>$, containing pointers to the callbacks for each countdown \\
\hline
\end{DoxyParams}
\hypertarget{customtimer_8c_aee1ba92a934e50c14af5def052598ca1}{\index{customtimer.\-c@{customtimer.\-c}!prepare\-\_\-single\-\_\-countdown@{prepare\-\_\-single\-\_\-countdown}}
\index{prepare\-\_\-single\-\_\-countdown@{prepare\-\_\-single\-\_\-countdown}!customtimer.c@{customtimer.\-c}}
\subsubsection[{prepare\-\_\-single\-\_\-countdown}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint8\-\_\-t} prepare\-\_\-single\-\_\-countdown (
\begin{DoxyParamCaption}
\item[{float}]{seconds, }
\item[{{\bf T\-\_\-\-C\-A\-L\-L\-B\-A\-C\-K}}]{callback}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_aee1ba92a934e50c14af5def052598ca1}


Prepare a single countdown. 

This function will prepare a single countdown and {\bfseries overwrite} all other existing countdowns. \begin{DoxyReturn}{Returns}
{\ttfamily {\bfseries 1}} on success, {\bfseries 0} on failure. 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em seconds} & desired length of the countdown \\
\hline
{\em callback} & Callback for the countdown \\
\hline
\end{DoxyParams}
\hypertarget{customtimer_8c_a29bbe0721066f0c40993910980eeda42}{\index{customtimer.\-c@{customtimer.\-c}!prescale\-\_\-1024@{prescale\-\_\-1024}}
\index{prescale\-\_\-1024@{prescale\-\_\-1024}!customtimer.c@{customtimer.\-c}}
\subsubsection[{prescale\-\_\-1024}]{\setlength{\rightskip}{0pt plus 5cm}void prescale\-\_\-1024 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{customtimer_8c_a29bbe0721066f0c40993910980eeda42}


Set the prescaler of T\-C\-C\-R1 to 1024. 

This will also cause the hardware-\/timer to start running. \hypertarget{customtimer_8c_ae17cda8a1068e9f0eb197408ce62dc33}{\index{customtimer.\-c@{customtimer.\-c}!reset\-\_\-all\-\_\-countdowns@{reset\-\_\-all\-\_\-countdowns}}
\index{reset\-\_\-all\-\_\-countdowns@{reset\-\_\-all\-\_\-countdowns}!customtimer.c@{customtimer.\-c}}
\subsubsection[{reset\-\_\-all\-\_\-countdowns}]{\setlength{\rightskip}{0pt plus 5cm}void reset\-\_\-all\-\_\-countdowns (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_ae17cda8a1068e9f0eb197408ce62dc33}


Stop and reset all configured countdowns. 

\hypertarget{customtimer_8c_a3ce5712f831e6d5a5a06104422c523b6}{\index{customtimer.\-c@{customtimer.\-c}!run\-\_\-countdown@{run\-\_\-countdown}}
\index{run\-\_\-countdown@{run\-\_\-countdown}!customtimer.c@{customtimer.\-c}}
\subsubsection[{run\-\_\-countdown}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint8\-\_\-t} run\-\_\-countdown (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_a3ce5712f831e6d5a5a06104422c523b6}


Execute all configured countdowns. 

\begin{DoxyReturn}{Returns}
{\ttfamily {\bfseries 1}} when the countdown(s) have been executed, {\bfseries 0} when a countdown is already running 
\end{DoxyReturn}
\hypertarget{customtimer_8c_acdb18153473a1f7725aded7d4c07f8d9}{\index{customtimer.\-c@{customtimer.\-c}!set\-\_\-ovfs\-\_\-and\-\_\-ticks@{set\-\_\-ovfs\-\_\-and\-\_\-ticks}}
\index{set\-\_\-ovfs\-\_\-and\-\_\-ticks@{set\-\_\-ovfs\-\_\-and\-\_\-ticks}!customtimer.c@{customtimer.\-c}}
\subsubsection[{set\-\_\-ovfs\-\_\-and\-\_\-ticks}]{\setlength{\rightskip}{0pt plus 5cm}void set\-\_\-ovfs\-\_\-and\-\_\-ticks (
\begin{DoxyParamCaption}
\item[{float}]{seconds, }
\item[{{\bf uint16\-\_\-t} $\ast$}]{t\-\_\-ovf, }
\item[{{\bf uint16\-\_\-t} $\ast$}]{t\-\_\-ticks}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_acdb18153473a1f7725aded7d4c07f8d9}


Calculate necessary overflows and timer-\/ticks. 

Calculate the necessary overlows and timer-\/ticks for a desired time. 
\begin{DoxyParams}{Parameters}
{\em seconds} & Desired time in seconds. \\
\hline
{\em t\-\_\-ovf} & Variable to be set to necessary overflows \\
\hline
{\em t\-\_\-ticks} & Variable to be set to necessary ticks \\
\hline
\end{DoxyParams}
\hypertarget{customtimer_8c_aaaac2a3612ddaaa092b2883d194c1328}{\index{customtimer.\-c@{customtimer.\-c}!start\-\_\-compare\-\_\-timer@{start\-\_\-compare\-\_\-timer}}
\index{start\-\_\-compare\-\_\-timer@{start\-\_\-compare\-\_\-timer}!customtimer.c@{customtimer.\-c}}
\subsubsection[{start\-\_\-compare\-\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}void start\-\_\-compare\-\_\-timer (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_aaaac2a3612ddaaa092b2883d194c1328}


Start the timer, triggering compare interrupts. 

\hypertarget{customtimer_8c_a32a1b40c5cc606cb2ec32424a49dd9db}{\index{customtimer.\-c@{customtimer.\-c}!start\-\_\-overflow\-\_\-timer@{start\-\_\-overflow\-\_\-timer}}
\index{start\-\_\-overflow\-\_\-timer@{start\-\_\-overflow\-\_\-timer}!customtimer.c@{customtimer.\-c}}
\subsubsection[{start\-\_\-overflow\-\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}void start\-\_\-overflow\-\_\-timer (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_a32a1b40c5cc606cb2ec32424a49dd9db}


Start the timer, triggering interrupts on overflows. 

\hypertarget{customtimer_8c_aa9854f34aab8315190c2d5945e54b058}{\index{customtimer.\-c@{customtimer.\-c}!start\-\_\-timer@{start\-\_\-timer}}
\index{start\-\_\-timer@{start\-\_\-timer}!customtimer.c@{customtimer.\-c}}
\subsubsection[{start\-\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}void start\-\_\-timer (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{customtimer_8c_aa9854f34aab8315190c2d5945e54b058}


Execute a timer, running the countdown at \-\_\-\-C\-T\-\_\-\-O.\-\_\-cur\-\_\-cd. 

\hypertarget{customtimer_8c_adaa3a4b597c87a8e1395fb1804dcbf23}{\index{customtimer.\-c@{customtimer.\-c}!stop\-\_\-timer@{stop\-\_\-timer}}
\index{stop\-\_\-timer@{stop\-\_\-timer}!customtimer.c@{customtimer.\-c}}
\subsubsection[{stop\-\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}void stop\-\_\-timer (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{customtimer_8c_adaa3a4b597c87a8e1395fb1804dcbf23}


\subsection{Variable Documentation}
\hypertarget{customtimer_8c_af5583a393df5eb6d7dbd289b13beba06}{\index{customtimer.\-c@{customtimer.\-c}!\-\_\-\-C\-T\-\_\-\-O@{\-\_\-\-C\-T\-\_\-\-O}}
\index{\-\_\-\-C\-T\-\_\-\-O@{\-\_\-\-C\-T\-\_\-\-O}!customtimer.c@{customtimer.\-c}}
\subsubsection[{\-\_\-\-C\-T\-\_\-\-O}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Custom\-Timer} \-\_\-\-C\-T\-\_\-\-O}}\label{customtimer_8c_af5583a393df5eb6d7dbd289b13beba06}
{\bfseries Initial value\-:}
\begin{DoxyCode}
= \{.\_cd\_ticks = \{0\},
                     .\_cd\_ovfs = \{0\},
                     .\_running = 0,
                     .\_cur\_passed\_overflows = 0,
                     .\_cur\_cd = 0,
                     .\_n\_cds = 0,
                     .\_timer\_callbacks = \{0\}\}
\end{DoxyCode}
Global variable \-\_\-\-C\-T\-\_\-\-O containing countdown configuration 